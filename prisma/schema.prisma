generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// User ====================================================================================================

model User {
  id          Int      @id @default(autoincrement())
  email       String   @unique
  password    String
  phone       String   @unique
  firstName   String
  surname     String
  patronymic  String
  country     String?
  region      String?
  settlement  String?
  avatar      String?
  ban         Boolean?
  banResponse String?
  role        Role     @default(USER)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

enum Role {
  USER
  ADMIN
}

// Banner ====================================================================================================

model Banner {
  id          Int      @id @default(autoincrement())
  title       String
  description String
  src         String
  alt         String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// GelPolishes

model GelPolishes {
  id                            Int                             @id @default(autoincrement())
  title                         String
  imageSrc                      String
  imageAlt                      String
  discount                      Boolean                         @default(false)
  publish                       Boolean                         @default(false)
  createdAt                     DateTime                        @default(now())
  updatedAt                     DateTime                        @updatedAt
  GelPolishesWithBrandSizePrice GelPolishesWithBrandSizePrice[]
}

model Brand {
  id                            Int                             @id @default(autoincrement())
  brand                         String
  GelPolishesWithBrandSizePrice GelPolishesWithBrandSizePrice[]
}

model Size {
  id                            Int                             @id @default(autoincrement())
  size                          String
  GelPolishesWithBrandSizePrice GelPolishesWithBrandSizePrice[]
}

model Price {
  id                            Int                             @id @default(autoincrement())
  price                         Float
  GelPolishesWithBrandSizePrice GelPolishesWithBrandSizePrice[]
}

model GelPolishesWithBrandSizePrice {
  gelPolish   GelPolishes @relation(fields: [gelPolishId], references: [id])
  gelPolishId Int
  brand       Brand       @relation(fields: [brandId], references: [id])
  brandId     Int
  size        Size        @relation(fields: [sizeId], references: [id])
  sizeId      Int
  price       Price       @relation(fields: [priceId], references: [id])
  priceId     Int

  @@id([gelPolishId, brandId, sizeId, priceId])
}

// Post ====================================================================================================

model Post {
  id         Int                 @id @default(autoincrement())
  title      String
  categories CategoriesOnPosts[]
}

model Category {
  id    Int                 @id @default(autoincrement())
  name  String
  posts CategoriesOnPosts[]
}

model CategoriesOnPosts {
  post       Post     @relation(fields: [postId], references: [id])
  postId     Int // relation scalar field (used in the `@relation` attribute above)
  category   Category @relation(fields: [categoryId], references: [id])
  categoryId Int // relation scalar field (used in the `@relation` attribute above)
  assignedAt DateTime @default(now())
  assignedBy String

  @@id([postId, categoryId])
}
